<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8" />
  <title>WhatsApp Pairing</title>
  <script src="/socket.io/socket.io.js"></script>
  <style>
    body { font-family: Arial; background: #f4f4f4; padding: 20px }
    .box { background: #fff; padding: 20px; max-width: 500px; margin: auto; border-radius: 8px }
    input, button { width: 100%; padding: 10px; margin-top: 10px }
    pre { background: #000; color: #0f0; padding: 10px; height: 200px; overflow: auto }
    .hidden { display: none }
  </style>
</head>
<body>

<div class="box">
  <h2>Iniciar Sess√£o</h2>

  <input id="session" placeholder="Nome da sess√£o" />
  <button onclick="start()">Iniciar</button>

  <div id="phoneBox" class="hidden">
    <p>üì± N√∫mero (Mo√ßambique)</p>
    <input id="phone" placeholder="Ex: 840604424" />
    <button onclick="sendPhone()">Enviar n√∫mero</button>
  </div>

  <div id="codeBox" class="hidden">
    <h3 id="code"></h3>
  </div>

  <pre id="logs"></pre>
</div>

<script>
  const socket = io()

  function start() {
    const name = document.getElementById('session').value
    socket.emit('start-session', name)
  }

  function sendPhone() {
    socket.emit('send-phone', {
      phone: document.getElementById('phone').value
    })
  }

  socket.on('request-phone', () => {
    document.getElementById('phoneBox').classList.remove('hidden')
  })

  socket.on('pairing-code', data => {
    document.getElementById('codeBox').classList.remove('hidden')
    document.getElementById('code').innerText = `C√≥digo: ${data.code}`
  })

  socket.on('pairing-expired', () => {
    document.getElementById('code').innerText = '‚åõ C√≥digo expirou'
  })

  socket.on('log', msg => {
    const logs = document.getElementById('logs')
    logs.textContent += msg + '\n'
    logs.scrollTop = logs.scrollHeight
  })
</script>

</body>
</html>
